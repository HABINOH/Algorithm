-- 코드를 작성해주세요

WITH ITEM_SELECT AS (
SELECT
 it.ITEM_ID
FROM
 ITEM_INFO ii
JOIN
 ITEM_TREE it
ON
 ii.ITEM_ID = it.ITEM_ID
WHERE
 it.PARENT_ITEM_ID in (SELECT ITEM_ID FROM ITEM_INFO WHERE RARITY = 'RARE') 
)
SELECT
 i2.ITEM_ID
,i2.ITEM_NAME
,i2.RARITY
FROM
 ITEM_SELECT i1
JOIN
 ITEM_INFO i2
ON
 i1.ITEM_ID = i2.ITEM_ID
ORDER BY
 1 DESC


