-- 코드를 입력하세요
WITH TOTAL_BOOK AS (
    SELECT 
    BOOK_ID, 
    SUM(SALES) AS SALES
    FROM BOOK_SALES
    WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 01
    GROUP BY BOOK_ID
    ORDER BY 1
)

SELECT 
  b.CATEGORY AS CATEGORY
, SUM(tb.sales) AS TOTAL_SALES
FROM BOOK b
JOIN TOTAL_BOOK tb
ON b.book_id = tb.book_id
GROUP BY b.CATEGORY
ORDER BY 1















# SELECT
# CATEGORY
# , SUM(s.SALES) AS TOTAL_SALES
# FROM BOOK b
# JOIN BOOK_SALES s
# ON b.BOOK_ID = s.BOOK_ID
# WHERE MONTH(s.SALES_DATE) = 01
# GROUP BY b.CATEGORY
# ORDER BY 1